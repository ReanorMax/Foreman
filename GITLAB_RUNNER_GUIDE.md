# –ì–∞–π–¥ –ø–æ GitLab Runner

–ö—Ä–∞—Ç–∫–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –¥–ª—è –∫–æ–ª–ª–µ–≥–∏ –ø–æ —Ä–∞–±–æ—Ç–µ —Å GitLab Runner –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ `192.168.0.108` (–∑–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ IP –≤–∞—à–µ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞).

## üìö –ß—Ç–æ —Ç–∞–∫–æ–µ GitLab Runner?

**GitLab Runner** ‚Äî —ç—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç CI/CD –∑–∞–¥–∞—á–∏ (jobs) –∏–∑ GitLab CI/CD pipeline. 

### –û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–Ω—è—Ç–∏—è:

- **Runner** ‚Äî —Å–µ—Ä–≤–∏—Å, –∫–æ—Ç–æ—Ä—ã–π –∑–∞–ø—É—Å–∫–∞–µ—Ç CI/CD –∑–∞–¥–∞—á–∏
- **Job** ‚Äî –æ—Ç–¥–µ–ª—å–Ω–∞—è –∑–∞–¥–∞—á–∞ –≤ pipeline (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–±–æ—Ä–∫–∞, —Ç–µ—Å—Ç, –¥–µ–ø–ª–æ–π)
- **Pipeline** ‚Äî –Ω–∞–±–æ—Ä –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö –∑–∞–¥–∞—á, –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö –≤ `.gitlab-ci.yml`
- **Executor** ‚Äî —Å–ø–æ—Å–æ–± –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞—á (Docker, Shell, Kubernetes –∏ —Ç.–¥.)

### –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:

1. –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ –ø—É—à–∏—Ç –∫–æ–¥ –≤ GitLab
2. GitLab –∑–∞–ø—É—Å–∫–∞–µ—Ç pipeline (–∑–∞–¥–∞—á–∏ –∏–∑ `.gitlab-ci.yml`)
3. Runner –ø–æ–ª—É—á–∞–µ—Ç –∑–∞–¥–∞—á–∏ –∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∏—Ö –≤ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞—Ö
4. –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –æ–±—Ä–∞—Ç–Ω–æ –≤ GitLab

---

## üîê –î–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–µ—Ä—É

- **–°–µ—Ä–≤–µ—Ä**: `192.168.0.108` (–∑–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ IP –≤–∞—à–µ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞)
- **–•–æ—Å—Ç**: `foreman.example.com` (–∑–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à FQDN)
- **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å**: `root`
- **–ü–∞—Ä–æ–ª—å**: `–í–ê–®_–ü–ê–†–û–õ–¨_–ó–î–ï–°–¨`
- **SSH –∫–æ–º–∞–Ω–¥–∞**: 
  ```bash
  ssh root@192.168.0.108
  ```

---

## üìä –¢–µ–∫—É—â–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ Runner'–µ

- **–í–µ—Ä—Å–∏—è**: `18.2.1` (Git revision: cc489270)
- **GitLab —Å–µ—Ä–≤–µ—Ä**: `http://192.168.0.20` (–∑–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ IP –≤–∞—à–µ–≥–æ GitLab —Å–µ—Ä–≤–µ—Ä–∞)
- **–°—Ç–∞—Ç—É—Å**: –ê–∫—Ç–∏–≤–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç (—Å 05.11.2025)
- **Executor**: Docker
- **Docker –≤–µ—Ä—Å–∏—è**: `20.10.24+dfsg1`
- **–û–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏**: `1` (concurrent = 1)
- **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–µ—Ä–≤–∏—Å–∞**: `gitlab-runner`
- **–†–∞–±–æ—á–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è**: `/home/gitlab-runner`

### –ù–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ Runner'—ã

#### 1. docker-runner

- **ID**: `0`
- **–ò–º—è**: `docker-runner`
- **Token**: `YOUR_TOKEN_HERE` (–≤ —Ä–µ–∞–ª—å–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏: `it5dxYzJNCwzkLvgT8gk`)
- **Executor**: `docker`
- **Docker Image**: `alpine:latest` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- **Privileged**: `true` (–ø—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–µ–∂–∏–º)
- **–ü—Ä–æ–µ–∫—Ç**: `Automatization/ansible` (Project ID: 89)
- **URL**: `http://192.168.0.20` (–∑–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ IP –≤–∞—à–µ–≥–æ GitLab)

**–ù–∞—Å—Ç—Ä–æ–π–∫–∏ Docker:**
- Volumes: `/var/run/docker.sock:/var/run/docker.sock`, `/cache`
- Pull policy: `if-not-present` (—Å–∫–∞—á–∏–≤–∞—Ç—å –æ–±—Ä–∞–∑ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç)
- TLS verify: `false`
- Network mode: –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
- –í—ã–ø–æ–ª–Ω—è–µ—Ç CI/CD –∑–∞–¥–∞—á–∏ –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞ `Automatization/ansible`
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –¥–ª—è –∏–∑–æ–ª—è—Ü–∏–∏ –∑–∞–¥–∞—á
- –ü–æ—Å–ª–µ–¥–Ω–∏–µ –∑–∞–¥–∞—á–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è, –Ω–æ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –ø–∞–¥–∞—é—Ç —Å –æ—à–∏–±–∫–∞–º–∏ (exit code 1)

#### 2. pbx-iac-runner

- **ID**: `15`
- **–ò–º—è**: `pbx-iac-runner`
- **Token**: `YOUR_TOKEN_HERE` (–≤ —Ä–µ–∞–ª—å–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏: `s26Ffck-UJny--FV5e1V`)
- **Executor**: `docker`
- **Docker Image**: `alpine:latest` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- **Privileged**: `true`
- **URL**: `http://192.168.0.20` (–∑–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ IP –≤–∞—à–µ–≥–æ GitLab)
- **–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω**: 09.10.2025

**–ù–∞—Å—Ç—Ä–æ–π–∫–∏ Docker:**
- Volumes: `/var/run/docker.sock:/var/run/docker.sock`, `/cache`
- Pull policy: `if-not-present`
- TLS verify: `false`

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
- –í—ã–ø–æ–ª–Ω—è–µ—Ç CI/CD –∑–∞–¥–∞—á–∏ –¥–ª—è –ø—Ä–æ–µ–∫—Ç–æ–≤ PBX IAC (Infrastructure as Code)
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è PBX —Å–∏—Å—Ç–µ–º–æ–π

---

## üöÄ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ GitLab Runner

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–∞ (–æ—Å–Ω–æ–≤–Ω–æ–π —Å–ø–æ—Å–æ–±)
systemctl status gitlab-runner.service

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–µ—Ä—Å–∏—é
gitlab-runner --version

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ GitLab (–ø—Ä–æ–≤–µ—Ä—è–µ—Ç –≤—Å–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ runner'—ã)
gitlab-runner verify
```

**–û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥ `gitlab-runner verify`:**
```
Runtime platform    arch=amd64 os=linux pid=<PID> revision=cc489270 version=18.2.1
Running in system-mode.

Verifying runner... is alive  runner=it5dxYzJN
Verifying runner... is alive  runner=s26Ffck-U
```

**–°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–∞ –¥–æ–ª–∂–µ–Ω –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å:**
```
‚óè gitlab-runner.service - GitLab Runner
   Loaded: loaded (/etc/systemd/system/gitlab-runner.service; enabled)
   Active: active (running) since ...
   Main PID: <PID> (gitlab-runner)
```

### –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ Runner'–∞

```bash
# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–∏—Å (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
systemctl restart gitlab-runner.service

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–µ—Ä–≤–∏—Å
systemctl stop gitlab-runner.service

# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–∏—Å
systemctl start gitlab-runner.service

# –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –±–µ–∑ –ø–æ–ª–Ω–æ–π –æ—Å—Ç–∞–Ω–æ–≤–∫–∏
gitlab-runner restart

# –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å systemd –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é (–µ—Å–ª–∏ –º–µ–Ω—è–ª–∏ unit —Ñ–∞–π–ª)
systemctl daemon-reload
systemctl restart gitlab-runner.service
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤

```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 50 —Å—Ç—Ä–æ–∫ –ª–æ–≥–æ–≤
journalctl -u gitlab-runner.service -n 50

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 100 —Å—Ç—Ä–æ–∫ –ª–æ–≥–æ–≤
journalctl -u gitlab-runner.service -n 100

# –°–ª–µ–¥–∏—Ç—å –∑–∞ –ª–æ–≥–∞–º–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ (–∫–∞–∫ tail -f)
journalctl -u gitlab-runner.service -f

# –ü–æ–∏—Å–∫ –æ—à–∏–±–æ–∫
journalctl -u gitlab-runner.service | grep -i error
journalctl -u gitlab-runner.service | grep "WARNING: Job failed"

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π —á–∞—Å
journalctl -u gitlab-runner.service --since "1 hour ago"

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –∑–∞ —Å–µ–≥–æ–¥–Ω—è
journalctl -u gitlab-runner.service --since today
```

**–¢–∏–ø–∏—á–Ω—ã–µ –∑–∞–ø–∏—Å–∏ –≤ –ª–æ–≥–∞—Ö:**
- `Checking for jobs... received` - –ø–æ–ª—É—á–∏–ª –Ω–æ–≤—É—é –∑–∞–¥–∞—á—É
- `Added job to processing list` - –¥–æ–±–∞–≤–∏–ª –∑–∞–¥–∞—á—É –≤ –æ—á–µ—Ä–µ–¥—å
- `Job failed: exit code 1` - –∑–∞–¥–∞—á–∞ –∑–∞–≤–µ—Ä—à–∏–ª–∞—Å—å —Å –æ—à–∏–±–∫–æ–π
- `Submitting job to coordinator...ok` - –æ—Ç–ø—Ä–∞–≤–∏–ª —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ GitLab
- `Removed job from processing list` - –∑–∞–≤–µ—Ä—à–∏–ª –æ–±—Ä–∞–±–æ—Ç–∫—É –∑–∞–¥–∞—á–∏

---

## üìã –ß—Ç–æ –¥–µ–ª–∞–µ—Ç Runner

### –¢–µ–∫—É—â–∏–µ –∑–∞–¥–∞—á–∏

**–ü—Ä–æ–µ–∫—Ç: Automatization/ansible (ID: 89)**

Runner –≤—ã–ø–æ–ª–Ω—è–µ—Ç CI/CD –∑–∞–¥–∞—á–∏ –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ Ansible. 

**–ü–æ—Å–ª–µ–¥–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏:**
- Job ID: 2834, 2835, 2836 (–≤—Å–µ –ø–∞–¥–∞–ª–∏ —Å –æ—à–∏–±–∫–æ–π `exit code 1`)
- –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π: `http://192.168.0.20/Automatization/ansible.git` (–∑–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ IP –≤–∞—à–µ–≥–æ GitLab)
- –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: ~90 —Å–µ–∫—É–Ω–¥ –Ω–∞ –∑–∞–¥–∞—á—É
- –°—Ç–∞—Ç—É—Å: Job –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è, –Ω–æ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –∑–∞–≤–µ—Ä—à–∞—é—Ç—Å—è —Å –æ—à–∏–±–∫–∞–º–∏

**–ü—Ä–∏–º–µ—Ä –ª–æ–≥–æ–≤ –∑–∞–¥–∞—á–∏:**
```
Checking for jobs... received  job=2836 repo_url=http://192.168.0.20/Automatization/ansible.git
Added job to processing list    builds=1 job=2836 max_builds=1
Appending trace to coordinator...ok  job-status=running
WARNING: Job failed: exit code 1  duration_s=91.601081879
Submitting job to coordinator...ok  job-status=
Removed job from processing list  builds=0
```

### –ü—Ä–æ–µ–∫—Ç—ã, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏–µ Runner

1. **Automatization/ansible** (Project ID: 89)
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç runner: `docker-runner`
   - –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π: `http://192.168.0.20/Automatization/ansible.git`
   - –ü–æ—Å–ª–µ–¥–Ω–∏–µ job'—ã –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è, –Ω–æ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –ø–∞–¥–∞—é—Ç —Å –æ—à–∏–±–∫–∞–º–∏
   - –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∑–∞–¥–∞—á: ~90 —Å–µ–∫—É–Ω–¥

2. **PBX IAC –ø—Ä–æ–µ–∫—Ç—ã**
   - –ò—Å–ø–æ–ª—å–∑—É—é—Ç runner: `pbx-iac-runner`
   - –î–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è PBX —Å–∏—Å—Ç–µ–º

### –¢–∏–ø–∏—á–Ω—ã–µ –∑–∞–¥–∞—á–∏ –≤ CI/CD:

1. **–°–±–æ—Ä–∫–∞** (Build)
   - –ö–æ–º–ø–∏–ª—è—Ü–∏—è –∫–æ–¥–∞
   - –°–æ–∑–¥–∞–Ω–∏–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤

2. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** (Test)
   - –ó–∞–ø—É—Å–∫ unit-—Ç–µ—Å—Ç–æ–≤
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞ (lint, format)

3. **–†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ** (Deploy)
   - –ó–∞–ø—É—Å–∫ Ansible playbook'–æ–≤
   - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π
   - –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä–∞—Ö

4. **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è** (Automation)
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã
   - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π
   - –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π

---

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Runner'–∞

### –§–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ**: `/etc/gitlab-runner/config.toml`

**–ü–æ–ª–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ:**
```toml
concurrent = 1                    # –û–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–¥–∞—á (1 = –ø–æ –æ—á–µ—Ä–µ–¥–∏)
check_interval = 0                # –ò–Ω—Ç–µ—Ä–≤–∞–ª –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–æ–≤—ã—Ö –∑–∞–¥–∞—á (0 = –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –ø—Ä–æ–≤–µ—Ä—è—Ç—å)
connection_max_age = "15m0s"      # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –≤–æ–∑—Ä–∞—Å—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
shutdown_timeout = 0              # –¢–∞–π–º–∞—É—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã

[session_server]
  session_timeout = 1800          # –¢–∞–π–º–∞—É—Ç —Å–µ—Å—Å–∏–∏ (30 –º–∏–Ω—É—Ç)

[[runners]]
  name = "docker-runner"
  url = "http://192.168.0.20"     # URL GitLab —Å–µ—Ä–≤–µ—Ä–∞
  id = 0
  token = "YOUR_TOKEN_HERE"       # ‚ö†Ô∏è –ó–ê–ú–ï–ù–ò–¢–ï –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω!
  token_obtained_at = 0001-01-01T00:00:00Z
  token_expires_at = 0001-01-01T00:00:00Z
  executor = "docker"
  [runners.docker]
    tls_verify = false
    image = "alpine:latest"       # –û–±—Ä–∞–∑ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
    privileged = true             # –ü—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–µ–∂–∏–º (–Ω—É–∂–µ–Ω –¥–ª—è Docker-in-Docker)
    disable_entrypoint_overwrite = false
    oom_kill_disable = false
    disable_cache = false
    volumes = ["/var/run/docker.sock:/var/run/docker.sock", "/cache"]
    pull_policy = ["if-not-present"]  # –°–∫–∞—á–∏–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –æ–±—Ä–∞–∑–∞ –Ω–µ—Ç
    shm_size = 0
    network_mtu = 0

[[runners]]
  name = "pbx-iac-runner"
  url = "http://192.168.0.20"     # URL GitLab —Å–µ—Ä–≤–µ—Ä–∞
  id = 15
  token = "YOUR_TOKEN_HERE"       # ‚ö†Ô∏è –ó–ê–ú–ï–ù–ò–¢–ï –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω!
  token_obtained_at = 2025-10-09T14:15:12Z
  token_expires_at = 0001-01-01T00:00:00Z
  executor = "docker"
  [runners.cache]
    MaxUploadedArchiveSize = 0
    [runners.cache.s3]
    [runners.cache.gcs]
    [runners.cache.azure]
  [runners.docker]
    tls_verify = false
    image = "alpine:latest"       # –û–±—Ä–∞–∑ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
    privileged = true
    disable_entrypoint_overwrite = false
    oom_kill_disable = false
    disable_cache = false
    volumes = ["/var/run/docker.sock:/var/run/docker.sock", "/cache"]
    shm_size = 0
    network_mtu = 0
```

### –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

```bash
# –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
nano /etc/gitlab-runner/config.toml
# –∏–ª–∏
vi /etc/gitlab-runner/config.toml

# –ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å runner
systemctl restart gitlab-runner.service
# –∏–ª–∏
gitlab-runner restart
```

**‚ö†Ô∏è –í–ê–ñ–ù–û:** 
- –ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ **–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ** –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ runner!
- –ù–µ —É–¥–∞–ª—è–π—Ç–µ —Ç–æ–∫–µ–Ω—ã - runner –Ω–µ —Å–º–æ–∂–µ—Ç –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ GitLab
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å TOML —Ñ–∞–π–ª–∞ –ø–µ—Ä–µ–¥ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–æ–º

---

## üê≥ Docker –∏ Runner

### –°—Ç–∞—Ç—É—Å Docker

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å Docker
systemctl status docker

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–µ—Ä—Å–∏—é
docker --version

# –ü—Ä–æ—Å–º–æ—Ç—Ä –∑–∞–ø—É—â–µ–Ω–Ω—ã—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
docker ps

# –ü—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ (–≤–∫–ª—é—á–∞—è –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ)
docker ps -a

# –ü—Ä–æ—Å–º–æ—Ç—Ä Docker –æ–±—Ä–∞–∑–æ–≤
docker images

# –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ Docker
docker info
```

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- Docker –≤–µ—Ä—Å–∏—è: `20.10.24+dfsg1`
- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤: 2 (–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö)
- –û–±—Ä–∞–∑–æ–≤: 44
- Storage Driver: `overlay2`
- Cgroup Driver: `systemd`

### Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã, —Å–æ–∑–¥–∞–≤–∞–µ–º—ã–µ Runner'–æ–º

Runner —Å–æ–∑–¥–∞–µ—Ç **–≤—Ä–µ–º–µ–Ω–Ω—ã–µ** Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞—á. –ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã —É–¥–∞–ª—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

**–í–∞–∂–Ω–æ:**
- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã —Å–æ–∑–¥–∞—é—Ç—Å—è –Ω–∞ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞—á–∏
- –ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è—é—Ç—Å—è
- –ï—Å–ª–∏ –∑–∞–¥–∞—á–∞ –ø–∞–¥–∞–µ—Ç - –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Ç–æ–∂–µ —É–¥–∞–ª—è–µ—Ç—Å—è

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ Runner'–∞:**
```bash
# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã (–≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞—á–∏)
docker ps | grep gitlab-runner

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã (–≤–∫–ª—é—á–∞—è –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ)
docker ps -a | grep gitlab-runner

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã (–º–æ–∂–µ—Ç –±—ã—Ç—å –º–Ω–æ–≥–æ)
docker ps -a
```

**–û—á–∏—Å—Ç–∫–∞ Docker:**
```bash
# –£–¥–∞–ª–∏—Ç—å –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
docker container prune

# –£–¥–∞–ª–∏—Ç—å –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –æ–±—Ä–∞–∑—ã
docker image prune

# –£–¥–∞–ª–∏—Ç—å –≤—Å–µ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ä–µ—Å—É—Ä—Å—ã (–æ—Å—Ç–æ—Ä–æ–∂–Ω–æ!)
docker system prune

# –£–¥–∞–ª–∏—Ç—å –≤—Å–µ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ä–µ—Å—É—Ä—Å—ã, –≤–∫–ª—é—á–∞—è –æ–±—Ä–∞–∑—ã (–æ—á–µ–Ω—å –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ!)
docker system prune -a
```

---

## üîç –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ Runner'–∞

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ runner –∞–∫—Ç–∏–≤–µ–Ω –∏ –ø–æ–¥–∫–ª—é—á–µ–Ω –∫ GitLab
gitlab-runner verify

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö runner'–æ–≤
gitlab-runner list

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–∞
systemctl status gitlab-runner.service --no-pager -l
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –∑–∞–¥–∞—á

```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –∑–∞–¥–∞—á
journalctl -u gitlab-runner.service -n 100 | grep -E "job=|Checking for jobs|repo_url="

# –ü–æ–∏—Å–∫ –æ—à–∏–±–æ–∫
journalctl -u gitlab-runner.service | grep "WARNING: Job failed"

# –ü—Ä–æ—Å–º–æ—Ç—Ä —É—Å–ø–µ—à–Ω—ã—Ö –∑–∞–¥–∞—á
journalctl -u gitlab-runner.service | grep "Job succeeded"

# –ü—Ä–æ—Å–º–æ—Ç—Ä –∑–∞–¥–∞—á –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞
journalctl -u gitlab-runner.service | grep "ansible.git"

# –ü–æ–¥—Å—á–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –∑–∞–¥–∞—á –∑–∞ —Å–µ–≥–æ–¥–Ω—è
journalctl -u gitlab-runner.service --since today | grep "Checking for jobs" | wc -l
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ CPU/–ø–∞–º—è—Ç–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ–º runner'–∞
top -p $(pgrep gitlab-runner)

# –ò–ª–∏ —á–µ—Ä–µ–∑ htop (–µ—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)
htop -p $(pgrep gitlab-runner)

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–∏—Å–∫–∞ —Ä–∞–±–æ—á–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–µ–π
df -h /home/gitlab-runner

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–∑–º–µ—Ä —Ä–∞–±–æ—á–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
du -sh /home/gitlab-runner/

# –î–µ—Ç–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –ø–æ –ø–æ–¥–¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è–º
du -sh /home/gitlab-runner/*/
```

---

## ‚ùå –¢–∏–ø–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

### 1. Runner –Ω–µ –ø–æ–ª—É—á–∞–µ—Ç –∑–∞–¥–∞—á–∏

**–°–∏–º–ø—Ç–æ–º—ã:**
- –í –ª–æ–≥–∞—Ö –Ω–µ—Ç "Checking for jobs"
- –í GitLab –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è "Runner offline"
- `gitlab-runner verify` –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç runner'–∞

**–†–µ—à–µ–Ω–∏–µ:**

```bash
# 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–∞
systemctl status gitlab-runner.service

# 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ GitLab
gitlab-runner verify

# 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
cat /etc/gitlab-runner/config.toml

# 4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–æ–∫–µ–Ω –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
cat /etc/gitlab-runner/config.toml | grep token

# 5. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å runner
systemctl restart gitlab-runner.service

# 6. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –Ω–∞ –æ—à–∏–±–∫–∏
journalctl -u gitlab-runner.service -n 50 | grep -i error
```

**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:**
- Runner –Ω–µ –∑–∞–ø—É—â–µ–Ω
- –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- –ü—Ä–æ–±–ª–µ–º—ã —Å —Å–µ—Ç–µ–≤—ã–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º –∫ GitLab (–ø—Ä–æ–≤–µ—Ä–∏—Ç—å `ping 192.168.0.20`)
- Runner –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –¥–ª—è –¥—Ä—É–≥–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞
- –¢–æ–∫–µ–Ω –∏—Å—Ç–µ–∫ –∏–ª–∏ –±—ã–ª —Å–±—Ä–æ—à–µ–Ω –≤ GitLab

---

### 2. –ó–∞–¥–∞—á–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è, –Ω–æ –ø–∞–¥–∞—é—Ç —Å –æ—à–∏–±–∫–∞–º–∏

**–°–∏–º–ø—Ç–æ–º—ã:**
- –í –ª–æ–≥–∞—Ö: `WARNING: Job failed: exit code 1`
- –ó–∞–¥–∞—á–∏ –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è, –Ω–æ –∑–∞–≤–µ—Ä—à–∞—é—Ç—Å—è —Å –æ—à–∏–±–∫–æ–π
- –í GitLab –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Å—Ç–∞—Ç—É—Å "failed"

**–†–µ—à–µ–Ω–∏–µ:**

```bash
# 1. –ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –¥–µ—Ç–∞–ª—å–Ω—ã–µ –ª–æ–≥–∏ –∑–∞–¥–∞—á–∏
journalctl -u gitlab-runner.service | grep -A 30 "job=<JOB_ID>"

# 2. –ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏ –≤ GitLab (–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø)
# –ü–µ—Ä–µ–π—Ç–∏ –≤ GitLab ‚Üí –ü—Ä–æ–µ–∫—Ç ‚Üí CI/CD ‚Üí Pipelines ‚Üí –í—ã–±—Ä–∞—Ç—å pipeline ‚Üí Job
# –¢–∞–º –±—É–¥—É—Ç –ø–æ–ª–Ω—ã–µ –ª–æ–≥–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞—á–∏

# 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Docker –æ–±—Ä–∞–∑
docker pull alpine:latest

# 4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å Docker socket
ls -la /var/run/docker.sock
# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: srw-rw---- 1 root docker

# 5. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è gitlab-runner
groups gitlab-runner
# –î–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≥—Ä—É–ø–ø–∞: docker

# 6. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é Docker –≤ runner'–µ
cat /etc/gitlab-runner/config.toml | grep -A 10 "runners.docker"
```

**–¢–∏–ø–∏—á–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:**
- –û—à–∏–±–∫–∏ –≤ CI/CD —Å–∫—Ä–∏–ø—Ç–∞—Ö (`.gitlab-ci.yml`) - —Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏ –≤ GitLab
- –ü—Ä–æ–±–ª–µ–º—ã —Å Docker –æ–±—Ä–∞–∑–æ–º (–æ–±—Ä–∞–∑ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –∏–ª–∏ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–∫–∞—á–∞–Ω)
- –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ
- –ü—Ä–æ–±–ª–µ–º—ã —Å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ
- –ü—Ä–æ–±–ª–µ–º—ã —Å —Å–µ—Ç–µ–≤—ã–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º –∏–∑ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
- –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–µ—Å—Ç–∞ –Ω–∞ –¥–∏—Å–∫–µ

**–ö–∞–∫ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏ –∑–∞–¥–∞—á–∏ –≤ GitLab:**
1. –û—Ç–∫—Ä—ã—Ç—å –ø—Ä–æ–µ–∫—Ç –≤ GitLab: `http://192.168.0.20` (–∑–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ IP –≤–∞—à–µ–≥–æ GitLab)
2. –ü–µ—Ä–µ–π—Ç–∏ –≤ **CI/CD ‚Üí Pipelines**
3. –í—ã–±—Ä–∞—Ç—å –Ω—É–∂–Ω—ã–π pipeline (–∫–æ—Ç–æ—Ä—ã–π –ø–∞–¥–∞–µ—Ç)
4. –ö–ª–∏–∫–Ω—É—Ç—å –Ω–∞ —É–ø–∞–≤—à—É—é –∑–∞–¥–∞—á—É (job)
5. –ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (—Ç–∞–º –±—É–¥–µ—Ç –¥–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –æ—à–∏–±–∫–µ)

---

### 3. Docker –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è

**–°–∏–º–ø—Ç–æ–º—ã:**
- –û—à–∏–±–∫–∏: `Cannot connect to the Docker daemon`
- Runner –Ω–µ –º–æ–∂–µ—Ç —Å–æ–∑–¥–∞—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
- `docker ps` –≤—ã–¥–∞–µ—Ç –æ—à–∏–±–∫—É

**–†–µ—à–µ–Ω–∏–µ:**

```bash
# 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å Docker
systemctl status docker

# 2. –ó–∞–ø—É—Å—Ç–∏—Ç—å Docker
systemctl start docker

# 3. –í–∫–ª—é—á–∏—Ç—å –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫ Docker
systemctl enable docker

# 4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ Docker socket
ls -la /var/run/docker.sock
# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: srw-rw---- 1 root docker

# 5. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å gitlab-runner –≤ –≥—Ä—É–ø–ø–µ docker
groups gitlab-runner
# –î–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≥—Ä—É–ø–ø–∞: docker

# 6. –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –≤ –≥—Ä—É–ø–ø–µ - –¥–æ–±–∞–≤–∏—Ç—å
usermod -aG docker gitlab-runner

# 7. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å runner
systemctl restart gitlab-runner.service

# 8. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ Docker
journalctl -u docker.service -n 50
```

---

### 4. Runner –Ω–µ –º–æ–∂–µ—Ç —Å–∫–∞—á–∞—Ç—å Docker –æ–±—Ä–∞–∑

**–°–∏–º–ø—Ç–æ–º—ã:**
- –û—à–∏–±–∫–∏: `pull access denied` –∏–ª–∏ `image not found`
- –ó–∞–¥–∞—á–∏ –Ω–µ –º–æ–≥—É—Ç –∑–∞–ø—É—Å—Ç–∏—Ç—å—Å—è

**–†–µ—à–µ–Ω–∏–µ:**

```bash
# 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –æ–±—Ä–∞–∑–∞ –≤—Ä—É—á–Ω—É—é
docker pull alpine:latest

# 2. –ï—Å–ª–∏ –æ–±—Ä–∞–∑ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥—Ä—É–≥–æ–π –æ–±—Ä–∞–∑
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å /etc/gitlab-runner/config.toml
# –ò–∑–º–µ–Ω–∏—Ç—å image = "alpine:latest" –Ω–∞ –¥—Ä—É–≥–æ–π –æ–±—Ä–∞–∑ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "debian:latest")

# 3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å runner
systemctl restart gitlab-runner.service

# 4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Å–µ—Ç–∏ –∏–∑ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ (–µ—Å–ª–∏ –æ–±—Ä–∞–∑ –Ω–µ —Å–∫–∞—á–∏–≤–∞–µ—Ç—Å—è)
docker run --rm alpine:latest ping -c 3 8.8.8.8
```

---

### 5. Runner –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç "offline" –≤ GitLab

**–°–∏–º–ø—Ç–æ–º—ã:**
- –í GitLab Runner –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∫–∞–∫ "offline"
- –ù–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ runner –∑–∞–ø—É—â–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç

**–†–µ—à–µ–Ω–∏–µ:**

```bash
# 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ runner –∑–∞–ø—É—â–µ–Ω –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
systemctl status gitlab-runner.service

# 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ GitLab —Å —Å–µ—Ä–≤–µ—Ä–∞
ping 192.168.0.20

# 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ runner'–∞ –∫ GitLab
gitlab-runner verify

# 4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–æ–∫–µ–Ω –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
cat /etc/gitlab-runner/config.toml | grep token

# 5. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å URL GitLab –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
cat /etc/gitlab-runner/config.toml | grep url

# 6. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å runner
systemctl restart gitlab-runner.service

# 7. –ü–æ–¥–æ–∂–¥–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∏–Ω—É—Ç (GitLab –æ–±–Ω–æ–≤–ª—è–µ—Ç —Å—Ç–∞—Ç—É—Å –Ω–µ –º–≥–Ω–æ–≤–µ–Ω–Ω–æ)

# 8. –í GitLab –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ runner'–∞
# GitLab ‚Üí Settings ‚Üí CI/CD ‚Üí Runners ‚Üí –ù–∞–π—Ç–∏ runner ‚Üí –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
# –ï—Å–ª–∏ –Ω—É–∂–Ω–æ - —Å–±—Ä–æ—Å–∏—Ç—å —Ç–æ–∫–µ–Ω –∏ –æ–±–Ω–æ–≤–∏—Ç—å –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
```

---

### 6. –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–µ—Å—Ç–∞ –Ω–∞ –¥–∏—Å–∫–µ

**–°–∏–º–ø—Ç–æ–º—ã:**
- –ó–∞–¥–∞—á–∏ –ø–∞–¥–∞—é—Ç —Å –æ—à–∏–±–∫–∞–º–∏ –æ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–µ –º–µ—Å—Ç–∞
- Docker –Ω–µ –º–æ–∂–µ—Ç —Å–æ–∑–¥–∞—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã

**–†–µ—à–µ–Ω–∏–µ:**

```bash
# 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–∏—Å–∫–∞
df -h

# 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–∑–º–µ—Ä —Ä–∞–±–æ—á–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ runner'–∞
du -sh /home/gitlab-runner/

# 3. –û—á–∏—Å—Ç–∏—Ç—å —Å—Ç–∞—Ä—ã–µ —Å–±–æ—Ä–∫–∏ (–æ—Å—Ç–æ—Ä–æ–∂–Ω–æ!)
cd /home/gitlab-runner/builds
# –£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ —Å–±–æ—Ä–æ–∫ (–µ—Å–ª–∏ –µ—Å—Ç—å)
rm -rf */old_build_*/

# 4. –û—á–∏—Å—Ç–∏—Ç—å Docker (–Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –æ–±—Ä–∞–∑—ã, –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã, –∫—ç—à)
docker system prune

# 5. –û—á–∏—Å—Ç–∏—Ç—å Docker –ø–æ–ª–Ω–æ—Å—Ç—å—é (–æ—á–µ–Ω—å –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ!)
docker system prune -a --volumes

# 6. –û—á–∏—Å—Ç–∏—Ç—å –∫—ç—à runner'–∞
rm -rf /home/gitlab-runner/.cache/*
```

---

## üîÑ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ Runner'–∞

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π runner:

```bash
# –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—ã–π runner
gitlab-runner register

# –ë—É–¥–µ—Ç –∑–∞–ø—Ä–æ—à–µ–Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:
# - GitLab URL: http://192.168.0.20 (–∑–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ IP –≤–∞—à–µ–≥–æ GitLab)
# - Registration token: (–ø–æ–ª—É—á–∏—Ç—å –≤ GitLab ‚Üí Settings ‚Üí CI/CD ‚Üí Runners ‚Üí Registration token)
# - Description: –Ω–∞–∑–≤–∞–Ω–∏–µ runner'–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "my-custom-runner")
# - Tags: —Ç–µ–≥–∏ –¥–ª—è –≤—ã–±–æ—Ä–∞ runner'–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –Ω–∞–ø—Ä–∏–º–µ—Ä, "docker,linux")
# - Executor: docker (–∏–ª–∏ –¥—Ä—É–≥–æ–π)
# - Docker image: alpine:latest (–∏–ª–∏ –¥—Ä—É–≥–æ–π, –Ω–∞–ø—Ä–∏–º–µ—Ä, "debian:latest")
# - Privileged: true (–µ—Å–ª–∏ –Ω—É–∂–µ–Ω –¥–æ—Å—Ç—É–ø –∫ Docker socket)
```

**–ü–æ–ª—É—á–µ–Ω–∏–µ Registration Token:**
1. –ó–∞–π—Ç–∏ –≤ GitLab: `http://192.168.0.20` (–∑–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ IP –≤–∞—à–µ–≥–æ GitLab —Å–µ—Ä–≤–µ—Ä–∞)
2. –ü–µ—Ä–µ–π—Ç–∏ –≤ –ø—Ä–æ–µ–∫—Ç –∏–ª–∏ –≥—Ä—É–ø–ø—É (–≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–æ–≥–æ, –≥–¥–µ –Ω—É–∂–µ–Ω runner)
3. **Settings ‚Üí CI/CD ‚Üí Runners**
4. –†–∞—Å–∫—Ä—ã—Ç—å —Ä–∞–∑–¥–µ–ª **Expand** (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
5. –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å **Registration token** (Instance runners / Group runners / Project runners)

**–ü–æ—Å–ª–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:**
- Runner –ø–æ—è–≤–∏—Ç—Å—è –≤ —Å–ø–∏—Å–∫–µ –≤ GitLab
- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–æ–±–∞–≤–∏—Ç—Å—è –≤ `/etc/gitlab-runner/config.toml`
- Runner –Ω–∞—á–Ω–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

---

## üìÅ –†–∞–±–æ—á–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏

### –û—Å–Ω–æ–≤–Ω–∞—è —Ä–∞–±–æ—á–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è

**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ**: `/home/gitlab-runner/`

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**
```
/home/gitlab-runner/
‚îú‚îÄ‚îÄ builds/              # –í—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –¥–ª—è —Å–±–æ—Ä–∫–∏ (—É–¥–∞–ª—è—é—Ç—Å—è –ø–æ—Å–ª–µ –∑–∞–¥–∞—á)
‚îú‚îÄ‚îÄ .ansible/            # Ansible –∫—ç—à –∏ —Ñ–∞–π–ª—ã (–¥–ª—è Ansible –∑–∞–¥–∞—á)
‚îú‚îÄ‚îÄ .ansible_async/      # –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏ Ansible
‚îú‚îÄ‚îÄ .cache/              # –ö—ç—à (—Ä–∞–∑–ª–∏—á–Ω—ã–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ)
‚îú‚îÄ‚îÄ .docker/             # Docker –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è gitlab-runner
‚îú‚îÄ‚îÄ .gitconfig           # Git –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îî‚îÄ‚îÄ .git-credentials     # Git credentials (—Ç–æ–∫–µ–Ω—ã –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è–º)
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –¥–∏—Å–∫–∞:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–∑–º–µ—Ä —Ä–∞–±–æ—á–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
du -sh /home/gitlab-runner/

# –î–µ—Ç–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –ø–æ –ø–æ–¥–¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è–º
du -sh /home/gitlab-runner/*/

# –ù–∞–π—Ç–∏ –±–æ–ª—å—à–∏–µ —Ñ–∞–π–ª—ã/–¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
find /home/gitlab-runner -type f -size +100M 2>/dev/null
find /home/gitlab-runner -type d -exec du -sh {} \; 2>/dev/null | sort -h | tail -10
```

**–û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö —Ñ–∞–π–ª–æ–≤ (–æ—Å—Ç–æ—Ä–æ–∂–Ω–æ!):**
```bash
# –û—á–∏—Å—Ç–∏—Ç—å —Å—Ç–∞—Ä—ã–µ —Å–±–æ—Ä–∫–∏ (–µ—Å–ª–∏ –æ–Ω–∏ –æ—Å—Ç–∞–ª–∏—Å—å)
cd /home/gitlab-runner/builds
rm -rf */old_*/  # –£–¥–∞–ª–∏—Ç—å —Ç–æ–ª—å–∫–æ —Å—Ç–∞—Ä—ã–µ, —É–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –∑–∞–¥–∞—á –Ω–µ—Ç!

# –û—á–∏—Å—Ç–∏—Ç—å –∫—ç—à (–æ—Å—Ç–æ—Ä–æ–∂–Ω–æ - –º–æ–∂–µ—Ç –∑–∞–º–µ–¥–ª–∏—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –∑–∞–¥–∞—á–∏)
rm -rf /home/gitlab-runner/.cache/*

# –ü–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ (–û–ß–ï–ù–¨ –û–°–¢–û–†–û–ñ–ù–û! –¢–æ–ª—å–∫–æ –µ—Å–ª–∏ —É–≤–µ—Ä–µ–Ω—ã!)
# cd /home/gitlab-runner
# rm -rf builds/* .cache/* .ansible_async/*
```

---

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –¢–æ–∫–µ–Ω—ã Runner'–∞

–¢–æ–∫–µ–Ω—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ `/etc/gitlab-runner/config.toml`

**–¢–µ–∫—É—â–∏–µ —Ç–æ–∫–µ–Ω—ã (–∞–Ω–æ–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã):**
- `docker-runner`: `YOUR_TOKEN_HERE` (–≤ —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏: `it5dxYzJNCwzkLvgT8gk`)
- `pbx-iac-runner`: `YOUR_TOKEN_HERE` (–≤ —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏: `s26Ffck-UJny--FV5e1V`)

**‚ö†Ô∏è –í–ê–ñ–ù–û:** 
- **–ù–µ –¥–µ–ª–∏—Ç–µ—Å—å —Ç–æ–∫–µ–Ω–∞–º–∏ –ø—É–±–ª–∏—á–Ω–æ!**
- –¢–æ–∫–µ–Ω—ã –¥–∞—é—Ç –ø–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é –∑–∞–¥–∞—á –≤ –ø—Ä–æ–µ–∫—Ç–µ
- –ï—Å–ª–∏ —Ç–æ–∫–µ–Ω —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω - **–Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ** —Å–±—Ä–æ—Å—å—Ç–µ –µ–≥–æ –≤ GitLab

**–°–±—Ä–æ—Å —Ç–æ–∫–µ–Ω–∞:**
1. –í GitLab: **Settings ‚Üí CI/CD ‚Üí Runners**
2. –ù–∞–π—Ç–∏ –Ω—É–∂–Ω—ã–π runner
3. –ù–∞–∂–∞—Ç—å **Reset token** (–∏–ª–∏ –∏–∫–æ–Ω–∫—É –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è)
4. –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—ã–π —Ç–æ–∫–µ–Ω
5. –û–±–Ω–æ–≤–∏—Ç—å —Ç–æ–∫–µ–Ω –≤ `/etc/gitlab-runner/config.toml`
6. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å runner: `systemctl restart gitlab-runner.service`

**–ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∞
ls -la /etc/gitlab-runner/config.toml
# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: -rw------- 1 root root (—Ç–æ–ª—å–∫–æ root –º–æ–∂–µ—Ç —á–∏—Ç–∞—Ç—å/–ø–∏—Å–∞—Ç—å)

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∞ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
chmod 600 /etc/gitlab-runner/config.toml
chown root:root /etc/gitlab-runner/config.toml
```

---

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ GitLab

### –ü—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç–∞—Ç—É—Å–∞ Runner'–∞ –≤ GitLab

1. –ó–∞–π—Ç–∏ –≤ GitLab: `http://192.168.0.20` (–∑–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ IP –≤–∞—à–µ–≥–æ GitLab —Å–µ—Ä–≤–µ—Ä–∞)
2. –ü–µ—Ä–µ–π—Ç–∏ –≤ **Admin Area ‚Üí Overview ‚Üí Runners** (–¥–ª—è –∞–¥–º–∏–Ω–æ–≤, –≤—Å–µ runner'—ã)
3. –ò–ª–∏ –≤ –ø—Ä–æ–µ–∫—Ç–µ: **Settings ‚Üí CI/CD ‚Üí Runners** (runner'—ã –ø—Ä–æ–µ–∫—Ç–∞)

**–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ runner'–µ:**
- **Status**: online/offline (–æ–Ω–ª–∞–π–Ω/–æ—Ñ–ª–∞–π–Ω)
- **Last contact**: –∫–æ–≥–¥–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π —Ä–∞–∑ –ø–æ–¥–∫–ª—é—á–∞–ª—Å—è –∫ GitLab
- **Projects**: –∫–∞–∫–∏–µ –ø—Ä–æ–µ–∫—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç runner
- **Jobs**: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –∑–∞–¥–∞—á
- **Tags**: —Ç–µ–≥–∏ runner'–∞ (–¥–ª—è –≤—ã–±–æ—Ä–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ runner'–∞)

### –ü—Ä–æ—Å–º–æ—Ç—Ä –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –∑–∞–¥–∞—á

1. –ü–µ—Ä–µ–π—Ç–∏ –≤ –ø—Ä–æ–µ–∫—Ç –≤ GitLab
2. **CI/CD ‚Üí Pipelines**
3. –í—ã–±—Ä–∞—Ç—å –Ω—É–∂–Ω—ã–π pipeline
4. –ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ –∑–∞–¥–∞—á–∏ (jobs) –∏ –∏—Ö —Å—Ç–∞—Ç—É—Å—ã:
   - ‚úÖ passed (—É—Å–ø–µ—à–Ω–æ)
   - ‚ùå failed (–æ—à–∏–±–∫–∞)
   - ‚è∏Ô∏è paused (–ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ)
   - ‚è≥ running (–≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è)

**–ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –∑–∞–¥–∞—á–∏:**
1. –í —Å–ø–∏—Å–∫–µ pipeline'–æ–≤ –≤—ã–±—Ä–∞—Ç—å –Ω—É–∂–Ω—ã–π
2. –ö–ª–∏–∫–Ω—É—Ç—å –Ω–∞ –∑–∞–¥–∞—á—É (job)
3. –ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –¥–µ—Ç–∞–ª—å–Ω—ã–µ –ª–æ–≥–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

---

## üõ†Ô∏è Systemd Unit —Ñ–∞–π–ª

**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ**: `/etc/systemd/system/gitlab-runner.service`

**–°–æ–¥–µ—Ä–∂–∏–º–æ–µ:**
```ini
[Unit]
Description=GitLab Runner
ConditionFileIsExecutable=/usr/bin/gitlab-runner
After=network.target 

[Service]
StartLimitInterval=5
StartLimitBurst=10
ExecStart=/usr/bin/gitlab-runner "run" "--config" "/etc/gitlab-runner/config.toml" "--working-directory" "/home/gitlab-runner" "--service" "gitlab-runner" "--user" "gitlab-runner"
Restart=always
RestartSec=120
EnvironmentFile=-/etc/sysconfig/gitlab-runner

[Install]
WantedBy=multi-user.target
```

**–ö–ª—é—á–µ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `Restart=always` - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞—Ç—å –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏
- `RestartSec=120` - –∂–¥–∞—Ç—å 120 —Å–µ–∫—É–Ω–¥ –ø–µ—Ä–µ–¥ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–æ–º
- `User=gitlab-runner` - –∑–∞–ø—É—Å–∫–∞—Ç—å –æ—Ç –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è gitlab-runner
- `WorkingDirectory=/home/gitlab-runner` - —Ä–∞–±–æ—á–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è

**–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
```bash
# –ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è unit —Ñ–∞–π–ª–∞
systemctl daemon-reload
systemctl restart gitlab-runner.service
```

---

## üõ†Ô∏è –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# ===== –û–°–ù–û–í–ù–´–ï –ö–û–ú–ê–ù–î–´ =====

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–µ—Ä—Å–∏—é
gitlab-runner --version

# –°–ø–∏—Å–æ–∫ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö runner'–æ–≤
gitlab-runner list

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ GitLab
gitlab-runner verify

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å runner
gitlab-runner restart

# –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–∞
systemctl status gitlab-runner.service

# –ü–æ–∫–∞–∑–∞—Ç—å –ª–æ–≥–∏
journalctl -u gitlab-runner.service -f

# ===== DOCKER =====

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Docker
docker ps
docker images
docker info

# –û—á–∏—Å—Ç–∏—Ç—å –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ Docker —Ä–µ—Å—É—Ä—Å—ã
docker system prune

# ===== –ú–û–ù–ò–¢–û–†–ò–ù–ì =====

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤
top -p $(pgrep gitlab-runner)

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–∏—Å–∫–∞
df -h
du -sh /home/gitlab-runner/

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ –∑–∞–¥–∞—á–∏
journalctl -u gitlab-runner.service -n 100 | grep "job="

# ===== –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø =====

# –ü—Ä–æ—Å–º–æ—Ç—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
cat /etc/gitlab-runner/config.toml

# –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
nano /etc/gitlab-runner/config.toml

# –ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è - –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å
systemctl restart gitlab-runner.service
```

---

## üìù –ß–µ–∫-–ª–∏—Å—Ç –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –¥–µ–ª

–ü—Ä–∏ –ø—Ä–∏–Ω—è—Ç–∏–∏ –¥–µ–ª –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:

- [ ] Runner –∑–∞–ø—É—â–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç (`systemctl status gitlab-runner.service`)
- [ ] Runner –ø–æ–¥–∫–ª—é—á–µ–Ω –∫ GitLab (`gitlab-runner verify` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤—Å–µ runner'—ã –∫–∞–∫ "is alive")
- [ ] Docker –∑–∞–ø—É—â–µ–Ω (`systemctl status docker`)
- [ ] –ü–æ—Å–ª–µ–¥–Ω–∏–µ –∑–∞–¥–∞—á–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è (–ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏: `journalctl -u gitlab-runner.service -n 50`)
- [ ] –õ–æ–≥–∏ –¥–æ—Å—Ç—É–ø–Ω—ã –∏ –Ω–µ—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫
- [ ] –ó–Ω–∞–µ—Ç–µ, –∫–∞–∫–∏–µ –ø—Ä–æ–µ–∫—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç runner'—ã (–ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ GitLab –∏–ª–∏ –ª–æ–≥–∞—Ö)
- [ ] –ó–Ω–∞–µ—Ç–µ, –∫–∞–∫ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å runner (`systemctl restart gitlab-runner.service`)
- [ ] –ó–Ω–∞–µ—Ç–µ, –≥–¥–µ –ª–æ–≥–∏ (`journalctl -u gitlab-runner.service`)
- [ ] –ó–Ω–∞–µ—Ç–µ, –∫–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –∑–∞–¥–∞—á –≤ GitLab (CI/CD ‚Üí Pipelines)
- [ ] –ó–Ω–∞–µ—Ç–µ, –≥–¥–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (`/etc/gitlab-runner/config.toml`)
- [ ] –ó–Ω–∞–µ—Ç–µ, –≥–¥–µ —Ä–∞–±–æ—á–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è (`/home/gitlab-runner/`)
- [ ] –ó–Ω–∞–µ—Ç–µ, –∫–∞–∫ –æ—á–∏—Å—Ç–∏—Ç—å Docker –∫—ç—à (`docker system prune`)
- [ ] –ó–Ω–∞–µ—Ç–µ, –∫–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–∏—Å–∫–∞ (`df -h`, `du -sh /home/gitlab-runner/`)

---

## üìû –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- **GitLab Runner –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: https://docs.gitlab.com/runner/
- **GitLab CI/CD –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: https://docs.gitlab.com/ee/ci/
- **Docker –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: https://docs.docker.com/
- **Systemd –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: https://www.freedesktop.org/software/systemd/man/systemd.service.html

---

## ‚ö†Ô∏è –í–ê–ñ–ù–´–ï –ó–ê–ú–ï–ß–ê–ù–ò–Ø

1. **–ü—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö —Å–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:**
   - –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ: `journalctl -u gitlab-runner.service -n 100`
   - –í GitLab: **CI/CD ‚Üí Pipelines ‚Üí –≤—ã–±—Ä–∞—Ç—å pipeline ‚Üí –≤—ã–±—Ä–∞—Ç—å job ‚Üí –ø—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏**

2. **–í—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–∏—Å–∫–∞:**
   - Docker –æ–±—Ä–∞–∑—ã –∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –º–æ–≥—É—Ç –∑–∞–Ω–∏–º–∞—Ç—å –º–Ω–æ–≥–æ –º–µ—Å—Ç–∞
   - –†–µ–≥—É–ª—è—Ä–Ω–æ –æ—á–∏—â–∞–π—Ç–µ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ä–µ—Å—É—Ä—Å—ã: `docker system prune`

3. **–¢–æ–∫–µ–Ω—ã - —ç—Ç–æ —Å–µ–∫—Ä–µ—Ç–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:**
   - –ù–µ –ø—É–±–ª–∏–∫—É–π—Ç–µ —Ç–æ–∫–µ–Ω—ã –≤ –æ—Ç–∫—Ä—ã—Ç—ã—Ö —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è—Ö
   - –†–µ–≥—É–ª—è—Ä–Ω–æ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

4. **–ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ runner:**
   - `systemctl restart gitlab-runner.service`

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2025-11-20
