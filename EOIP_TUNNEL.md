# –ü—Ä–æ–µ–∫—Ç EoIP Tunnel

–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –ø—Ä–æ–µ–∫—Ç—É `sma1/eoip-tunnel` –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –¥–µ–ª –∫–æ–ª–ª–µ–≥–µ.

---

## üìã –û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

### –ü—Ä–æ–µ–∫—Ç

- **–ù–∞–∑–≤–∞–Ω–∏–µ**: `EoIP Tunnel` (EoIP Tunnel –ú–µ–Ω–µ–¥–∂–º–µ–Ω—Ç)
- **GitLab URL**: `http://10.19.1.20/sma1/eoip-tunnel`
- **ID –ø—Ä–æ–µ–∫—Ç–∞**: `72`
- **–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π**: `http://10.19.1.20/sma1/eoip-tunnel.git`
- **–°–æ–∑–¥–∞–Ω**: `2025-01-14`
- **–í–µ—Ç–∫–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é**: `main` (–∑–∞—â–∏—â–µ–Ω–∞)
- **–¢–µ–≥–∏**: –Ω–µ—Ç

---

## üí° –ß—Ç–æ –¥–µ–ª–∞–µ—Ç –ø—Ä–æ–µ–∫—Ç

### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

**EoIP Tunnel –ú–µ–Ω–µ–¥–∂–º–µ–Ω—Ç** - —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ eoIP-—Ç—É–Ω–Ω–µ–ª–µ–π –Ω–∞ —Å–µ—Ç–µ–≤—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö MikroTik.

**–û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —Ç—É–Ω–Ω–µ–ª–µ–π** - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ eoIP-—Ç—É–Ω–Ω–µ–ª–µ–π –º–µ–∂–¥—É –∫–ª–∏–µ–Ω—Ç–æ–º –∏ —Å–µ—Ä–≤–µ—Ä–æ–º
- ‚úÖ **Whitelist –∫–æ–Ω—Ç—Ä–æ–ª—å** - –ø—Ä–æ–≤–µ—Ä–∫–∞ MAC-–∞–¥—Ä–µ—Å–æ–≤ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –≤ —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω–æ–º —Å–ø–∏—Å–∫–µ
- ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ tunnel-id** - —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç—É–Ω–Ω–µ–ª—è
- ‚úÖ **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–π** - –∑–∞–ø–∏—Å—å –¥–µ–π—Å—Ç–≤–∏–π –≤ —Ñ–∞–π–ª—ã –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
- ‚úÖ **–°—Ç–∞—Ç—É—Å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** - –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Ç—É–Ω–Ω–µ–ª–µ–π
- ‚úÖ **Bridge –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç—É–Ω–Ω–µ–ª–µ–π –≤ bridge-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
MikroTik Client (–ö–ª–∏–µ–Ω—Ç)  ‚Üê SSH ‚Üí  MikroTik Server (–°–µ—Ä–≤–µ—Ä)
         ‚îÇ                                  ‚îÇ
         ‚îÇ      EoIP Tunnel (—É–Ω–∏–∫–∞–ª—å–Ω—ã–π)     ‚îÇ
         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                    ‚Üì
              Bridge Interface
```

### –ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã

1. **–ö–ª–∏–µ–Ω—Ç** –∑–∞–ø—É—Å–∫–∞–µ—Ç `Client_init` –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
2. **–ö–ª–∏–µ–Ω—Ç** –∑–∞–ø—É—Å–∫–∞–µ—Ç `Client_base` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ç—É–Ω–Ω–µ–ª—è
3. **–ö–ª–∏–µ–Ω—Ç** –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É –ø–æ SSH –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–≤–æ–π MAC-–∞–¥—Ä–µ—Å
4. **–°–µ—Ä–≤–µ—Ä** –ø—Ä–æ–≤–µ—Ä—è–µ—Ç MAC-–∞–¥—Ä–µ—Å –≤ whitelist —Ñ–∞–π–ª–µ (`flash/allowed_macs.txt`)
5. **–°–µ—Ä–≤–µ—Ä** –ø—Ä–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–∏ —Å–æ–∑–¥–∞–µ—Ç —Ç—É–Ω–Ω–µ–ª—å —Å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º `tunnel-id` –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
6. **–ö–ª–∏–µ–Ω—Ç** –ø–æ–ª—É—á–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏ —Å–æ–∑–¥–∞–µ—Ç —Å–≤–æ–π eoIP-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
7. **–ö–ª–∏–µ–Ω—Ç** –¥–æ–±–∞–≤–ª—è–µ—Ç —Ç—É–Ω–Ω–µ–ª—å –≤ bridge-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
8. **–°–µ—Ä–≤–µ—Ä** –ª–æ–≥–∏—Ä—É–µ—Ç –æ–ø–µ—Ä–∞—Ü–∏—é –≤ —Ñ–∞–π–ª (`flash/output.txt`)
9. **–°–µ—Ä–≤–µ—Ä** –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç —Å—Ç–∞—Ç—É—Å—ã —Ç—É–Ω–Ω–µ–ª–µ–π —á–µ—Ä–µ–∑ `eoip_status_updater`

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
eoip-tunnel/
‚îú‚îÄ‚îÄ üìã README.md                # –û—Å–Ω–æ–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞
‚îú‚îÄ‚îÄ üìã Client_init              # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–∞ (RouterOS —Å–∫—Ä–∏–ø—Ç)
‚îú‚îÄ‚îÄ üìã Client_base              # –û—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç –∫–ª–∏–µ–Ω—Ç–∞ (RouterOS —Å–∫—Ä–∏–ø—Ç)
‚îú‚îÄ‚îÄ üìã Server_init              # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–µ—Ä–≤–µ—Ä–∞ (RouterOS —Å–∫—Ä–∏–ø—Ç)
‚îú‚îÄ‚îÄ üìã Server_base.rsc          # –û—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç —Å–µ—Ä–≤–µ—Ä–∞ (RouterOS —Å–∫—Ä–∏–ø—Ç)
‚îî‚îÄ‚îÄ üìã eoip_status_updater      # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤ —Ç—É–Ω–Ω–µ–ª–µ–π (RouterOS —Å–∫—Ä–∏–ø—Ç)
```

---

## üåø –í–µ—Ç–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞

### –í–µ—Ç–∫–∞ `main` (–∑–∞—â–∏—â–µ–Ω–∞)

**–°—Ç–∞—Ç—É—Å**: –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é, –∑–∞—â–∏—â–µ–Ω–∞ –æ—Ç –ø—Ä—è–º–æ–≥–æ –ø—É—à–∞  
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –û—Å–Ω–æ–≤–Ω–∞—è —Å—Ç–∞–±–∏–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è –ø—Ä–æ–µ–∫—Ç–∞  
**–ü–æ—Å–ª–µ–¥–Ω–∏–π –∫–æ–º–º–∏—Ç**: `9c263ed8` - "Update README.md"

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ**: –û—Å–Ω–æ–≤–Ω–∞—è —Ä–∞–±–æ—á–∞—è –≤–µ—Ä—Å–∏—è –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: –í –ø—Ä–æ–µ–∫—Ç–µ —Ç–æ–ª—å–∫–æ –æ–¥–Ω–∞ –≤–µ—Ç–∫–∞ `main`, –¥—Ä—É–≥–∏—Ö –≤–µ—Ç–æ–∫ –Ω–µ—Ç.

---

## üè∑Ô∏è –¢–µ–≥–∏ –ø—Ä–æ–µ–∫—Ç–∞

**–¢–µ–≥–æ–≤ –≤ –ø—Ä–æ–µ–∫—Ç–µ –Ω–µ—Ç.**

---

## üîß –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### 1. Client_init (–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–∞)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –Ω–∞ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ

**–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:**
- `bridgeName` - –∏–º—è bridge-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: "Loopback")
- `interfaceName` - –∏–º—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è IP (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: "Loopback")
- `serverIP` - IP-–∞–¥—Ä–µ—Å —Å–µ—Ä–≤–µ—Ä–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: "10.19.1.122")
- `serverUser` - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å SSH –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: "admin")
- `eoIPName` - –∏–º—è eoIP-—Ç—É–Ω–Ω–µ–ª—è (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: "eoIP-to-server")
- `tunnelID` - –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Ç—É–Ω–Ω–µ–ª—è (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 0)

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
- –ò–∑–≤–ª–µ–∫–∞–µ—Ç –∏–º—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ (`deviceName`)
- –ü–æ–ª—É—á–∞–µ—Ç MAC-–∞–¥—Ä–µ—Å bridge-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ (`myMac`)
- –ü–æ–ª—É—á–∞–µ—Ç IP-–∞–¥—Ä–µ—Å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ (`myIP`)
- –í—ã–≤–æ–¥–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–µ–∫—É—â–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
# –ù–∞ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–º MikroTik —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ
/system script run Client_init
```

---

### 2. Client_base (–û—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç –∫–ª–∏–µ–Ω—Ç–∞)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è —Ç—É–Ω–Ω–µ–ª—è, –ø–æ–ª—É—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Å —Å–µ—Ä–≤–µ—Ä–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç—É–Ω–Ω–µ–ª—è

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
1. **–ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —Ç—É–Ω–Ω–µ–ª—è** - –∑–∞–≤–µ—Ä—à–∞–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å –æ—à–∏–±–∫–æ–π, –µ—Å–ª–∏ —Ç—É–Ω–Ω–µ–ª—å —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
2. **–ü–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É –ø–æ SSH** - –ø–æ–ª—É—á–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã `IntConnect` –∏ `tunnelID` —Å —Å–µ—Ä–≤–µ—Ä–∞
3. **–ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ** - —Å—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç `IntConnect` —Å –ª–æ–∫–∞–ª—å–Ω—ã–º MAC-–∞–¥—Ä–µ—Å–æ–º
4. **–°–æ–∑–¥–∞–µ—Ç —Ç—É–Ω–Ω–µ–ª—å** - –µ—Å–ª–∏ MAC —Ä–∞–∑—Ä–µ—à–µ–Ω, —Å–æ–∑–¥–∞–µ—Ç eoIP-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ —Å —Å–µ—Ä–≤–µ—Ä–∞
5. **–ê–∫—Ç–∏–≤–∏—Ä—É–µ—Ç —Ç—É–Ω–Ω–µ–ª—å** - –≤–∫–ª—é—á–∞–µ—Ç eoIP-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
6. **–î–æ–±–∞–≤–ª—è–µ—Ç –≤ bridge** - –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –≤ bridge –∏ –¥–æ–±–∞–≤–ª—è–µ—Ç –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
7. **–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä** - –µ—Å–ª–∏ MAC –Ω–µ —Ä–∞–∑—Ä–µ—à–µ–Ω, –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
# –ù–∞ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–º MikroTik —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ (–ø–æ—Å–ª–µ Client_init)
/system script run Client_base
```

**–û—à–∏–±–∫–∏:**
- `Error: Tunnel 'eoIP-to-server' already exists` - —Ç—É–Ω–Ω–µ–ª—å —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
- `Error: Failed to connect to SSH server` - –Ω–µ —É–¥–∞–ª–æ—Å—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É
- `Error: Failed to retrieve IntConnect and tunnelID from server` - —Å–µ—Ä–≤–µ—Ä –Ω–µ –≤–µ—Ä–Ω—É–ª –¥–∞–Ω–Ω—ã–µ

---

### 3. Server_init (–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–µ—Ä–≤–µ—Ä–∞)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ñ–∞–π–ª–æ–≤ –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –Ω–∞ —Å–µ—Ä–≤–µ—Ä–Ω–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ

**–ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:**
- `allowedMacsFile` - —Ñ–∞–π–ª —Å —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–º–∏ MAC-–∞–¥—Ä–µ—Å–∞–º–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: "flash/allowed_macs.txt")
- `logFile` - —Ñ–∞–π–ª –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: "flash/output.txt")
- `invalidMacsFile` - —Ñ–∞–π–ª –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö MAC (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: "flash/invalid_macs.txt")
- `bridgeName` - –∏–º—è bridge-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: "lo")
- `eoIPName` - –∏–º—è eoIP-—Ç—É–Ω–Ω–µ–ª—è (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: "eoip-tunnel")

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
1. **–ü—Ä–æ–≤–µ—Ä—è–µ—Ç/—Å–æ–∑–¥–∞–µ—Ç —Ñ–∞–π–ª –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö MAC** - —Å–æ–∑–¥–∞–µ—Ç `flash/invalid_macs.txt`, –µ—Å–ª–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
2. **–ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Ñ–∞–π–ª whitelist** - –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –∏ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ `flash/allowed_macs.txt`
3. **–ü—Ä–æ–≤–µ—Ä—è–µ—Ç/—Å–æ–∑–¥–∞–µ—Ç —Ñ–∞–π–ª –ª–æ–≥–∞** - —Å–æ–∑–¥–∞–µ—Ç `flash/output.txt`, –µ—Å–ª–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
4. **–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ** - —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –Ω–∞—á–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä–Ω–æ–º MikroTik —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ
/system script run Server_init
```

**–û—à–∏–±–∫–∏:**
- `Error: File 'flash/allowed_macs.txt' does not exist` - —Ñ–∞–π–ª whitelist –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
- `Error: File 'flash/allowed_macs.txt' is empty` - —Ñ–∞–π–ª whitelist –ø—É—Å—Ç–æ–π

---

### 4. Server_base.rsc (–û—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç —Å–µ—Ä–≤–µ—Ä–∞)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä–∫–∞ MAC-–∞–¥—Ä–µ—Å–æ–≤ –≤ whitelist, —Å–æ–∑–¥–∞–Ω–∏–µ —Ç—É–Ω–Ω–µ–ª–µ–π –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
1. **–ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—Ç–∞—Ç—É—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è** - –∑–∞–≤–µ—Ä—à–∞–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ, –µ—Å–ª–∏ `Status = 0`
2. **–ß–∏—Ç–∞–µ—Ç whitelist** - –∑–∞–≥—Ä—É–∂–∞–µ—Ç —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ `flash/allowed_macs.txt`
3. **–ò—â–µ—Ç MAC –≤ whitelist** - –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ MAC-–∞–¥—Ä–µ—Å–∞ –∫–ª–∏–µ–Ω—Ç–∞ –≤ —Å–ø–∏—Å–∫–µ
4. **–°–æ–∑–¥–∞–µ—Ç —Ç—É–Ω–Ω–µ–ª—å** - –ø—Ä–∏ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–∏:
   - –£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç `tunnelID` –Ω–∞ 1 (—É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä)
   - –°–æ–∑–¥–∞–µ—Ç eoIP-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å —É–¥–∞–ª–µ–Ω–Ω—ã–º –∞–¥—Ä–µ—Å–æ–º –∫–ª–∏–µ–Ω—Ç–∞
   - –ê–∫—Ç–∏–≤–∏—Ä—É–µ—Ç —Ç—É–Ω–Ω–µ–ª—å
   - –î–æ–±–∞–≤–ª—è–µ—Ç —Ç—É–Ω–Ω–µ–ª—å –≤ bridge-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
   - –õ–æ–≥–∏—Ä—É–µ—Ç –æ–ø–µ—Ä–∞—Ü–∏—é –≤ `flash/output.txt`
5. **–õ–æ–≥–∏—Ä—É–µ—Ç –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ MAC** - –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ MAC –≤ whitelist:
   - –ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç –≤ `flash/invalid_macs.txt`
   - –í—ã–¥–∞–µ—Ç –æ—à–∏–±–∫—É

**–§–æ—Ä–º–∞—Ç –ª–æ–≥–∞:**
```
tunnelID = 1; STATUS = 1; IP = 10.19.1.100; MAC = aa:bb:cc:dd:ee:ff; DeviceName = client-router; DateTime = 2025-11-21 15:30:00;
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä–Ω–æ–º MikroTik —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ
# –°–∫—Ä–∏–ø—Ç –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ SSH –∏–∑ Client_base
# –ò–ª–∏ –º–æ–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å –≤—Ä—É—á–Ω—É—é:
/system script run Server_base
```

**–û—à–∏–±–∫–∏:**
- `EXIT Status Connection 0` - —Å—Ç–∞—Ç—É—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è —Ä–∞–≤–µ–Ω 0
- `Invalid MAC 'aa:bb:cc:dd:ee:ff'` - MAC-–∞–¥—Ä–µ—Å –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ whitelist

---

### 5. eoip_status_updater (–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤ eoIP-—Ç—É–Ω–Ω–µ–ª–µ–π –≤ –ª–æ–≥-—Ñ–∞–π–ª–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏—Ö —Ä–µ–∞–ª—å–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
1. **–ß–∏—Ç–∞–µ—Ç –ª–æ–≥-—Ñ–∞–π–ª** - –∑–∞–≥—Ä—É–∂–∞–µ—Ç —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ `flash/output.txt`
2. **–ò—â–µ—Ç –∑–∞–ø–∏—Å–∏ —Ç—É–Ω–Ω–µ–ª–µ–π** - –Ω–∞—Ö–æ–¥–∏—Ç —Å—Ç—Ä–æ–∫–∏ —Å `tunnelID = ...`
3. **–ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ç—É–Ω–Ω–µ–ª–µ–π** - –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, –∑–∞–ø—É—â–µ–Ω—ã –ª–∏ —Ç—É–Ω–Ω–µ–ª–∏ (`running = true`)
4. **–û–±–Ω–æ–≤–ª—è–µ—Ç —Å—Ç–∞—Ç—É—Å** - –∏–∑–º–µ–Ω—è–µ—Ç `STATUS` –≤ –ª–æ–≥–µ:
   - `STATUS = 1` - —Ç—É–Ω–Ω–µ–ª—å —Å–æ–∑–¥–∞–Ω, –Ω–æ –Ω–µ –ø—Ä–æ–≤–µ—Ä–µ–Ω
   - `STATUS = 2` - —Ç—É–Ω–Ω–µ–ª—å —Ä–∞–±–æ—Ç–∞–µ—Ç (`running = true`)
5. **–°–æ—Ö—Ä–∞–Ω—è–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –ª–æ–≥** - –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ–±—Ä–∞—Ç–Ω–æ –≤ —Ñ–∞–π–ª

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä–Ω–æ–º MikroTik —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ
# –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∑–∞–ø—É—Å–∫–∞—Ç—å –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —á–µ—Ä–µ–∑ scheduler)
/system script run eoip_status_updater

# –ò–ª–∏ —á–µ—Ä–µ–∑ scheduler (–∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç):
/system scheduler add name=update-eoip-status interval=5m on-event=eoip_status_updater
```

---

## üìù –§–∞–π–ª—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä–Ω–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ

### flash/allowed_macs.txt (Whitelist)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –°–ø–∏—Å–æ–∫ —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã—Ö MAC-–∞–¥—Ä–µ—Å–æ–≤ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç—É–Ω–Ω–µ–ª–µ–π

**–§–æ—Ä–º–∞—Ç:**
```
aa:bb:cc:dd:ee:ff
11:22:33:44:55:66
ff:ee:dd:cc:bb:aa
```

**–û–¥–∏–Ω MAC-–∞–¥—Ä–µ—Å –Ω–∞ —Å—Ç—Ä–æ–∫—É** (–±–µ–∑ –ø—Ä–æ–±–µ–ª–æ–≤ –∏ –¥—Ä—É–≥–∏—Ö —Å–∏–º–≤–æ–ª–æ–≤)

**–í–∞–∂–Ω–æ**: –≠—Ç–æ—Ç —Ñ–∞–π–ª **–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û** –¥–æ–ª–∂–µ–Ω —Å—É—â–µ—Å—Ç–≤–æ–≤–∞—Ç—å –∏ —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω MAC-–∞–¥—Ä–µ—Å!

**–°–æ–∑–¥–∞–Ω–∏–µ/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä–Ω–æ–º MikroTik —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ
/file print
/file set allowed_macs.txt contents="aa:bb:cc:dd:ee:ff\r\n11:22:33:44:55:66\r\n"
```

---

### flash/output.txt (–õ–æ–≥ –æ–ø–µ—Ä–∞—Ü–∏–π)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –õ–æ–≥ —Å–æ–∑–¥–∞–Ω–∏—è —Ç—É–Ω–Ω–µ–ª–µ–π –∏ –∏—Ö —Å—Ç–∞—Ç—É—Å–æ–≤

**–§–æ—Ä–º–∞—Ç:**
```
tunnelID = 1; STATUS = 2; IP = 10.19.1.100; MAC = aa:bb:cc:dd:ee:ff; DeviceName = client-router; DateTime = 2025-11-21 15:30:00;
tunnelID = 2; STATUS = 2; IP = 10.19.1.101; MAC = 11:22:33:44:55:66; DeviceName = client-router-2; DateTime = 2025-11-21 15:35:00;
```

**–ü–æ–ª—è:**
- `tunnelID` - —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Ç—É–Ω–Ω–µ–ª—è
- `STATUS` - —Å—Ç–∞—Ç—É—Å —Ç—É–Ω–Ω–µ–ª—è (1 = —Å–æ–∑–¥–∞–Ω, 2 = —Ä–∞–±–æ—Ç–∞–µ—Ç)
- `IP` - IP-–∞–¥—Ä–µ—Å –∫–ª–∏–µ–Ω—Ç–∞
- `MAC` - MAC-–∞–¥—Ä–µ—Å –∫–ª–∏–µ–Ω—Ç–∞
- `DeviceName` - –∏–º—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –∫–ª–∏–µ–Ω—Ç–∞
- `DateTime` - –¥–∞—Ç–∞ –∏ –≤—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ**: –§–∞–π–ª —Å–æ–∑–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ `Server_init`

---

### flash/invalid_macs.txt (–õ–æ–≥ –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö MAC)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –õ–æ–≥ –ø–æ–ø—ã—Ç–æ–∫ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è —Å –Ω–µ—Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–º–∏ MAC-–∞–¥—Ä–µ—Å–∞–º–∏

**–§–æ—Ä–º–∞—Ç:**
```
STATUS = 1; IP = 10.19.1.200; MAC = 99:88:77:66:55:44; DeviceName = unauthorized-client; DateTime = 2025-11-21 16:00:00;
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ**: –î–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –ø–æ–ø—ã—Ç–æ–∫ –Ω–µ—Å–∞–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ**: –§–∞–π–ª —Å–æ–∑–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ `Server_init`

---

## üöÄ –ü—Ä–æ—Ü–µ—Å—Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞

1. **–ó–∞–≥—Ä—É–∑–∏—Ç—å —Å–∫—Ä–∏–ø—Ç—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä**:
   ```bash
   # –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ñ–∞–π–ª—ã –Ω–∞ MikroTik —Å–µ—Ä–≤–µ—Ä
   # Server_init, Server_base.rsc, eoip_status_updater
   ```

2. **–°–æ–∑–¥–∞—Ç—å whitelist —Ñ–∞–π–ª**:
   ```bash
   /file set allowed_macs.txt contents="aa:bb:cc:dd:ee:ff\r\n11:22:33:44:55:66\r\n"
   ```

3. **–ó–∞–ø—É—Å—Ç–∏—Ç—å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é**:
   ```bash
   /system script run Server_init
   ```

4. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å scheduler –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–æ–≤** (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):
   ```bash
   /system scheduler add name=update-eoip-status interval=5m on-event=eoip_status_updater
   ```

5. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å SSH –¥–æ—Å—Ç—É–ø**:
   - –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ SSH —Å–µ—Ä–≤–µ—Ä –≤–∫–ª—é—á–µ–Ω
   - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∫–ª—é—á–∏ –∏–ª–∏ –ø–∞—Ä–æ–ª—å –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è `admin`

---

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–ª–∏–µ–Ω—Ç–∞

1. **–ó–∞–≥—Ä—É–∑–∏—Ç—å —Å–∫—Ä–∏–ø—Ç—ã –Ω–∞ –∫–ª–∏–µ–Ω—Ç**:
   ```bash
   # –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ñ–∞–π–ª—ã –Ω–∞ MikroTik –∫–ª–∏–µ–Ω—Ç
   # Client_init, Client_base
   ```

2. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ Client_init**:
   ```bash
   # –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏:
   # - serverIP (IP-–∞–¥—Ä–µ—Å —Å–µ—Ä–≤–µ—Ä–∞)
   # - serverUser (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å SSH)
   # - bridgeName (–∏–º—è bridge-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞)
   # - interfaceName (–∏–º—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è IP)
   ```

3. **–ó–∞–ø—É—Å—Ç–∏—Ç—å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é**:
   ```bash
   /system script run Client_init
   ```

4. **–ó–∞–ø—É—Å—Ç–∏—Ç—å –æ—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç**:
   ```bash
   /system script run Client_base
   ```

5. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç**:
   ```bash
   /interface eoip print
   /interface bridge port print
   ```

---

## üìû –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–ª—è –∫–æ–ª–ª–µ–≥–∏

### –ü—Ä–∏ –ø—Ä–∏–Ω—è—Ç–∏–∏ –¥–µ–ª –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:

- [ ] –ü—Ä–æ–µ–∫—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –≤ GitLab (`http://10.19.1.20/sma1/eoip-tunnel`)
- [ ] –°–∫—Ä–∏–ø—Ç—ã –∑–∞–≥—Ä—É–∂–µ–Ω—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä–Ω–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ (Server_init, Server_base.rsc, eoip_status_updater)
- [ ] –°–∫—Ä–∏–ø—Ç—ã –∑–∞–≥—Ä—É–∂–µ–Ω—ã –Ω–∞ –∫–ª–∏–µ–Ω—Ç—Å–∫–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ (Client_init, Client_base)
- [ ] –§–∞–π–ª `flash/allowed_macs.txt` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –∏ —Å–æ–¥–µ—Ä–∂–∏—Ç —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ MAC-–∞–¥—Ä–µ—Å–∞
- [ ] SSH –¥–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–µ—Ä—É –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω scheduler –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–æ–≤ (–µ—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è)
- [ ] –ü–æ–Ω—è—Ç–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞:
  - **Client_init** - –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–∞
  - **Client_base** - –æ—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç –∫–ª–∏–µ–Ω—Ç–∞ (—Å–æ–∑–¥–∞–Ω–∏–µ —Ç—É–Ω–Ω–µ–ª—è)
  - **Server_init** - –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–µ—Ä–≤–µ—Ä–∞ (—Å–æ–∑–¥–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤)
  - **Server_base.rsc** - –æ—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç —Å–µ—Ä–≤–µ—Ä–∞ (–ø—Ä–æ–≤–µ—Ä–∫–∞ whitelist, —Å–æ–∑–¥–∞–Ω–∏–µ —Ç—É–Ω–Ω–µ–ª–µ–π)
  - **eoip_status_updater** - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤ —Ç—É–Ω–Ω–µ–ª–µ–π
- [ ] –ó–Ω–∞–µ—Ç–µ, –∫–∞–∫ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ MAC-–∞–¥—Ä–µ—Å–∞ –≤ whitelist
- [ ] –ó–Ω–∞–µ—Ç–µ, –∫–∞–∫ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –ª–æ–≥–∏ (`flash/output.txt`, `flash/invalid_macs.txt`)
- [ ] –ó–Ω–∞–µ—Ç–µ, –∫–∞–∫ –ø—Ä–æ–≤–µ—Ä—è—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ç—É–Ω–Ω–µ–ª–µ–π (`/interface eoip print`)

### –¢–∏–ø–∏—á–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏

1. **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞**:
   - –î–æ–±–∞–≤–∏—Ç—å MAC-–∞–¥—Ä–µ—Å –∫–ª–∏–µ–Ω—Ç–∞ –≤ `flash/allowed_macs.txt` –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
   - –ó–∞–ø—É—Å—Ç–∏—Ç—å `Client_init` –∏ `Client_base` –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ

2. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Ç—É–Ω–Ω–µ–ª–µ–π**:
   ```bash
   # –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ
   /interface eoip print
   /file print file=output.txt
   ```

3. **–£–¥–∞–ª–µ–Ω–∏–µ —Ç—É–Ω–Ω–µ–ª—è**:
   ```bash
   # –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ
   /interface eoip remove [find name=eoip-tunnel]
   
   # –ù–∞ –∫–ª–∏–µ–Ω—Ç–µ
   /interface eoip remove [find name=eoIP-to-server]
   ```

4. **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤**:
   ```bash
   # –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ
   /system script run eoip_status_updater
   ```

5. **–ü—Ä–æ—Å–º–æ—Ç—Ä –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π**:
   ```bash
   # –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ
   /file print file=invalid_macs.txt
   ```

### –¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏

1. **"Error: File 'flash/allowed_macs.txt' does not exist"**:
   - –°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª: `/file set allowed_macs.txt contents="mac1\r\nmac2\r\n"`

2. **"Error: Tunnel 'eoIP-to-server' already exists"**:
   - –£–¥–∞–ª–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Ç—É–Ω–Ω–µ–ª—å: `/interface eoip remove [find name=eoIP-to-server]`

3. **"Error: Failed to connect to SSH server"**:
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å SSH –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Å–µ—Ä–≤–µ—Ä–∞
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ `Client_init`

4. **"Invalid MAC 'aa:bb:cc:dd:ee:ff'"**:
   - –î–æ–±–∞–≤–∏—Ç—å MAC-–∞–¥—Ä–µ—Å –≤ `flash/allowed_macs.txt` –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

---

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **Whitelist –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω** - —Ñ–∞–π–ª `flash/allowed_macs.txt` –¥–æ–ª–∂–µ–Ω —Å—É—â–µ—Å—Ç–≤–æ–≤–∞—Ç—å –∏ —Å–æ–¥–µ—Ä–∂–∞—Ç—å MAC-–∞–¥—Ä–µ—Å–∞
2. **–£–Ω–∏–∫–∞–ª—å–Ω—ã–µ tunnel-id** - –∫–∞–∂–¥—ã–π –Ω–æ–≤—ã–π —Ç—É–Ω–Ω–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–π `tunnel-id` (–∏–Ω–∫—Ä–µ–º–µ–Ω—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ)
3. **SSH –¥–æ—Å—Ç—É–ø** - –∫–ª–∏–µ–Ω—Ç –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å SSH –¥–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–µ—Ä—É
4. **Bridge –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã** - —Ç—É–Ω–Ω–µ–ª–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –≤ —É–∫–∞–∑–∞–Ω–Ω—ã–µ bridge-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã
5. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** - –≤—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤ —Ñ–∞–π–ª—ã –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–µ–≥–æ –∞–Ω–∞–ª–∏–∑–∞
6. **–°—Ç–∞—Ç—É—Å—ã** - —Å—Ç–∞—Ç—É—Å—ã –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è —á–µ—Ä–µ–∑ `eoip_status_updater`, —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å scheduler

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2025-11-21  
**–í–µ—Ä—Å–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞:** 1.0  
**–°—Ç–∞—Ç—É—Å:** –ì–æ—Ç–æ–≤–æ –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –¥–µ–ª

