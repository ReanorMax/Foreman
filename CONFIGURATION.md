# Инструкция по настройке переменных перед использованием

Перед использованием конфигурации замените следующие значения на ваши реальные данные:

## IP-адреса и сетевые настройки

### Foreman сервер
- `192.168.0.100` → IP-адрес вашего Foreman сервера
- `server.example.com` → FQDN вашего Foreman сервера
- `192.168.0.1` → IP-адрес шлюза в вашей сети

### Сеть
- `192.168.0.0/24` → Ваша подсеть
- `192.168.0.6` → IP-адрес DNS сервера
- `192.168.0.100` → IP-адрес TFTP/HTTPBoot сервера (Foreman)

### Nexus/Артефакты репозиторий
- `x.x.x.x:8081` → IP-адрес и порт вашего Nexus/артефакты репозитория
- Или `nexus.example.com:8081` → FQDN вашего Nexus сервера

### Хосты (клиенты)
- `192.168.0.10` → IP-адрес первого клиента
- `192.168.0.11` → IP-адрес второго клиента
- `aa:bb:cc:dd:ee:ff` → MAC-адрес первого клиента
- `11:22:33:44:55:66` → MAC-адрес второго клиента

## Файлы, где нужно заменить значения

### 1. DHCP конфигурация

**Файл:** `configs/dhcp/dhcpd.conf`
- Замените все `192.168.0.x` на ваши реальные IP-адреса
- Замените `server.example.com` на ваш FQDN
- Замените `192.168.0.1` на IP вашего шлюза
- Замените `192.168.0.6` на IP вашего DNS сервера

**Файл:** `configs/dhcp/dhcpd.hosts`
- Замените MAC-адреса на реальные (`aa:bb:cc:dd:ee:ff` → ваш MAC)
- Замените IP-адреса на реальные (`192.168.0.10` → ваш IP)
- Замените имена хостов на реальные (`host1.example.com` → ваше имя)

### 2. Foreman-proxy конфигурация

**Файл:** `configs/foreman-proxy/settings.yml`
- Замените `server.example.com` на ваш FQDN в `:foreman_url` и `:trusted_hosts`
- Замените `192.168.0.100` на IP вашего Foreman сервера в `:trusted_hosts`
- Проверьте пути к SSL сертификатам (они зависят от FQDN)

**Файл:** `configs/foreman-proxy/templates.yml`
- Замените `http://192.168.0.100:8000` на URL вашего Smart Proxy

### 3. iPXE скрипт

**Файл:** `configs/ipxe/autoexec.ipxe`
- Замените `192.168.0.100` на IP вашего Foreman сервера в URL

### 4. Provisioning шаблон

**Файл:** `docs/05-provisioning-templates/Template_196_Preseed_via_PTable.erb`
- Замените `x.x.x.x:8081` на IP/URL вашего Nexus репозитория во всех `wget` командах
- Замените примеры WWN (`wwn-0x5000c500a1234567`) на реальные или оставьте пустыми (будут браться из переменных хоста)

### 5. Документация

Во всех файлах документации (`docs/**/*.md`) замените:
- Примеры IP-адресов на ваши реальные
- Примеры MAC-адресов на реальные
- Примеры имен хостов на реальные

## Переменные хоста в Foreman

После настройки конфигурации, в веб-интерфейсе Foreman создайте хосты с следующими переменными:

### Для LUKS/TPM шифрования:

```
disk_sys = /dev/disk/by-id/wwn-0xYOUR_WWN_HERE
disk_data = /dev/disk/by-id/wwn-0xYOUR_WWN_HERE
data_mount = /home/storage/local
crypto_passphrase = TestPassword  # ⚠️ ЗАМЕНИТЕ на реальный пароль!
var_size = 40G
root_size = 100G
home_size = 20G
swap_size = 2G
```

### Для RAID1:

```
disk_sys = /dev/sda
```

**⚠️ ВАЖНО:** 
- Пароли должны быть реальными и надежными
- WWN можно получить командой: `ls -l /dev/disk/by-id/ | grep wwn`
- MAC-адреса должны соответствовать реальным сетевым картам

## Пароли

Все пароли в конфигурации установлены как `TestPassword` или берутся из переменных хоста.

**⚠️ ОБЯЗАТЕЛЬНО замените:**
- Пароль root в шаблонах (через переменную хоста)
- `crypto_passphrase` на реальный пароль для LUKS
- Любые другие пароли на реальные значения

## Проверка перед использованием

1. Проверьте все IP-адреса соответствуют вашей сети
2. Проверьте все FQDN разрешаются в DNS
3. Проверьте доступность Nexus/артефакты репозитория
4. Проверьте MAC-адреса соответствуют реальным сетевым картам
5. Проверьте пароли заменены на реальные

## Безопасность

- Никогда не коммитьте реальные пароли в git
- Используйте переменные хоста в Foreman для паролей
- Используйте зашифрованные параметры Foreman для чувствительных данных
- Регулярно обновляйте пароли

